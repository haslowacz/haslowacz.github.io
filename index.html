<!DOCTYPE html>
<html lang="pl">
<head>
<meta charset="UTF-8">
<title>Generator haseł</title>
<meta name="viewport" content="width=device-width,initial-scale=1">
<link rel="icon" type="image/png" href="icon.png">
<style>
@import url('https://fonts.googleapis.com/css?family=VT323&display=swap');
body{margin:0;background:#131516;color:#f7e8ce;font-family:VT323,monospace;min-height:100vh}
.container{max-width:900px;margin:0 auto;padding:5vh 5vw}
.title{color:#ffe082;font-size:2em;margin-bottom:.5em}
.subtitle{color:#ff66cc;margin-bottom:1em}
.button{font-family:VT323,monospace;font-size:1.3em;padding:.3em 1.6em;color:#ffe082;background:transparent;border:2.5px solid #ffe082;border-radius:10px;cursor:pointer;box-shadow:0 2px 14px #000c;transition:.2s}
.button:hover{background:#23262a}
.list{margin-top:2em;display:flex;flex-direction:column;gap:1em}
.item{background:#181a1d;border:2px solid #80ffd7;border-radius:10px;padding:.6em .8em;display:flex;align-items:center;justify-content:space-between;gap:1em;width: 60%}
.pass{word-break: break-all;color: #fffbe6;font-size: clamp(1.4em, 2.5vw, 2em);}
.copy{font-family:VT323,monospace;font-size:1em;padding:.2em .8em;border:2px solid #ff66cc;border-radius:8px;background:transparent;color:#ff66cc;cursor:pointer}
.copy:hover{background:#2a1f28}
.footer{margin-top:3em;color:#80ffd7;font-size:.9em}
.site-footer {margin-top: 2.5em;padding-top: 1em;border-top: 1px dashed #80ffd744;display: flex;justify-content: center;align-items: center;gap: .6em;font-size: .9em;color: #80ffd7;}
.site-footer a {color: #ff66cc;text-decoration: none;transition: color .2s ease, text-shadow .2s ease;}
.site-footer a:hover {color: #ffe082;text-shadow: 0 0 6px #ffe082, 0 0 12px #ff66cc;}
.site-footer .sep {color: #ffe082;opacity: .6;}
</style>
</head>
<body>
<div class="container">
  <div class="title">Generator haseł</div>
  <div class="subtitle">2 polskie słowa + 2 cyfry + 2 znaki specjalne</div>
  <button class="button" id="genBtn">Generuj 5 haseł</button>
  <div class="list" id="list"></div>
  <div class="footer">Format hasła: SłowoSłowo13#$</div>
  <div class="footer">Autor: Damian Stańczak</div>
  <div class="site-footer">
    <span>© <span id="year"></span> Generator haseł</span>
    <span class="sep">•</span>
    <a href="https://github.com/haslowacz/haslowacz.github.io" target="_blank">GitHub</a>
    <a href="https://pl.linkedin.com/in/damian-stanczak" target="_blank" class="linkedin">LinkedIn</a>
  </div>
</div>

<script>
let WORDS = [];
let READY = false;

const specials = ['!','@','#','$','%','&','*','?','+','-','_'];
const list = document.getElementById('list');
const btn = document.getElementById('genBtn');

function rand(arr){ return arr[Math.floor(Math.random()*arr.length)] }
function randDigit(){ return Math.floor(Math.random()*10) }
function cap(w){ return w.charAt(0).toUpperCase() + w.slice(1) }

function normalizePL(str){
  const map = {
    'ą':'a','ć':'c','ę':'e','ł':'l','ń':'n','ó':'o','ś':'s','ż':'z','ź':'z',
    'Ą':'A','Ć':'C','Ę':'E','Ł':'L','Ń':'N','Ó':'O','Ś':'S','Ż':'Z','Ź':'Z'
  };
  return str.replace(/[ąćęłńóśżźĄĆĘŁŃÓŚŻŹ]/g, m => map[m] || m);
}

async function loadWords(){
  try{
    const res = await fetch('baza.txt', { cache: 'no-store' });
    if(!res.ok) throw new Error('HTTP ' + res.status);

    const text = await res.text();

    WORDS = text
      .replace(/^\uFEFF/, '')
      .split(/\r?\n/)
      .map(w => w.trim().toLowerCase())
      .filter(w => w.length >= 5);

    READY = true;
    btn.disabled = false;
    btn.textContent = 'Generuj 5 haseł';

    console.log('Załadowano słów:', WORDS.length);
  } catch(e){
    console.error('Błąd ładowania baza.txt:', e);
    btn.textContent = 'BŁĄD ŁADOWANIA BAZY';
    btn.disabled = true;
  }
}

function generatePassword(){
  if(!READY || WORDS.length === 0) return 'BŁĄD_BRAK_BAZY';

  const w1 = normalizePL(cap(rand(WORDS)));
  const w2 = normalizePL(cap(rand(WORDS)));
  const d1 = randDigit();
  const d2 = randDigit();
  const s1 = rand(specials);
  const s2 = rand(specials);

  return `${w1}${w2}${d1}${d2}${s1}${s2}`;
}

btn.addEventListener('click',()=>{
  if(!READY){
    alert('Baza słów jeszcze się ładuje.');
    return;
  }

  list.innerHTML = '';
  for(let i=0;i<5;i++){
    const pass = generatePassword();

    const div = document.createElement('div');
    div.className = 'item';

    const span = document.createElement('span');
    span.className = 'pass';
    span.textContent = pass;

    const b = document.createElement('button');
    b.className = 'copy';
    b.textContent = 'Kopiuj';
    b.onclick = ()=>{
      navigator.clipboard.writeText(pass);
      b.textContent = 'Skopiowano';
      setTimeout(()=>b.textContent='Kopiuj',1200);
    };

    div.appendChild(span);
    div.appendChild(b);
    list.appendChild(div);
  }
});

btn.disabled = true;
btn.textContent = 'Ładowanie bazy…';
loadWords();
document.getElementById('year').textContent = new Date().getFullYear();
</script>
</body>
</html>
